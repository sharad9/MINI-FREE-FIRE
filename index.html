<html>
    <head>
       
        <title></title>
    </head>
    <body>
    <meta name="viewport"
  content="
    height = device-height,
    width = device-width,
    initial-scale = 1.0,
    minimum-scale = 1.0,
    maximum-scale = 1.0,
    user-scalable = no,
    target-densitydpi = device-dpi
    " />

      <br><br>
    <div class="pads" id="touchPadFire"></div>

        <div class="pads" id="touchPad"></div>
        <div class="pads" id="padDot"></div>
        <canvas id="canvas"></canvas>
        
        <img id="tank1" src="https://i.ibb.co/LRFsjhy/Clipart-Key-1708882.png">
     
      

    



<script>
window.addEventListener('load', function(){

    
    var log = console.log;
    
    
    var enemies = []; //array to hold n enemies
    var enemyImg = new Image();
    enemyImg.src = "https://image.ibb.co/gi6ZpU/ufo.png";   // "https://image.ibb.co/bX9UuU/ufo_1.png"; //
    var enemy_width = 30;
    var enemy_height = 30;
    var enemy_health=5;
    
    var lastTime=0;
    var bullet_width=2,bullet_height=8;
    var bullets=[];
    

    var myTouchPad = document.getElementById( "touchPad");
    var myPadDot = document.getElementById( "padDot");
 
    var tank1 = document.getElementById('tank1');
    
    var currentX;
    var currentY;
    var points=0;

    var alpha;
    var radiusLimit;
    
    var ratio=window.innerHeight/window.innerWidth;
  
    var xCenter = window.innerWidth/1.3;
    var yCenter = (window.innerHeight/1.2)
    var degree;
    var speed_x = 0;
    var speed_y = 0;
    var player_x =  window.innerWidth/2;
    var player_y = (window.innerHeight/2);


    var player; 
    var player_health=100;      
    var move=false;
    var fire=false;
    var tank1Pos={x:0,y:0};


    
    myTouchPad.style.visibility="hidden";
    
    
    document.addEventListener('touchstart', function(e){

myTouchPad.style.visibility="visible";
    
    var touchobj = e.changedTouches[0];
        
        
         xCenter=touchobj.pageX ;
         yCenter =touchobj.pageY ;
         
         myTouchPad.style.top=yCenter-myTouchPad.offsetWidth/2;
    myTouchPad.style.left=xCenter-myTouchPad.offsetHeight/2;
    
     
         
    radiusLimit=myTouchPad.offsetWidth/2-myPadDot.offsetWidth/2;

    });
    
    
    
    
    
 document.addEventListener('touchmove', function(e){
        move=true;
        fire=true;
        
        var  touchobj = e.changedTouches[0];
        myPadDot.style.display = "inline";
        
        currentX = parseInt(touchobj.pageX, 10) - xCenter;
        currentY = parseInt(touchobj.pageY, 10) - yCenter;


        
        x2 = Math.pow( currentX,2)
        y2 = Math.pow( currentY ,2)
        currentPos = Math.sqrt(x2 + y2);
        alpha = Math.atan( currentY / currentX );
        
        if (currentX<0){
        alpha=alpha+Math.PI;
        }
        degree=(alpha)*(180/Math.PI);
        
        if(degree<0){degree+=360;}
        
        degree+=90;

        tank1.style.transform = "rotate("+(degree)+"deg)";
        if (currentPos < radiusLimit){
        speed_x = currentX/20;
        speed_y =currentY/(20);
         myPadDot.style.left = touchobj.pageX;
         myPadDot.style.top = touchobj.pageY;
         
         }
         else{
         

        myPadDot.style.left = radiusLimit*Math.cos(alpha)+xCenter-myPadDot.offsetWidth/2;
        speed_x =(radiusLimit*Math.cos(alpha))/20;
        myPadDot.style.top =( radiusLimit*Math.sin(alpha)+ yCenter)-myPadDot.offsetWidth/2;
        speed_y=(radiusLimit*Math.sin(alpha))/20;
        
        
         }
       

    });
    
document.addEventListener('touchend', function(e){
        myPadDot.style.left=xCenter-myPadDot.offsetWidth/2;
        myPadDot.style.top=yCenter-myPadDot.offsetWidth/2;
       myPadDot.style.display = "none";
       myTouchPad.style.visibility="hidden";
       
        speed_x=0;
        speed_y=0;
        move =false;
        fire=false;

    });
    
    
    
    var canvas = id("canvas");
var c = canvas.getContext("2d");





canvas.width = window.innerWidth*2;
canvas.height = window.innerHeight*2;

  
function id(arg){
  return document.getElementById(arg);
} 
 
 

class Player{
    constructor(x, y, width, height,health){

        this.x = x;
        this.y = y;
        this.width = width;
        this.height = height;
        
        this.health = health;
    }

    update(){
        c.beginPath();
        c.save();
        

        // Rotate player
        c.translate(this.x + (this.width), this.y + (this.height));
        c.rotate(degree * Math.PI/180);
        c.translate(-this.x -(this.width/2), -this.y -this.height/2);
        var health_left=(this.health/player_health);
        c.fillStyle="blue"
        //c.fillRect( this.x, this.y+this.height, this.width*health_left, this.height/10 );
        c.lineWidth=0.5;


        //c.fillStyle = this.color;
        c.fillStyle="red"
        c.lineWidth = 0.5;
        //c.rect(this.x, this.y, this.width, this.height);
        tank1Pos.x =this.x;
        tank1Pos.y=this.y;
        tank1.style.left=this.x+this.width/2;
        tank1.style.top=this.y+this.height*1.25;

        c.stroke();
       // c.fill();
        c.restore();
        c.closePath();
      
    
        if(this.x + this.width*2 > canvas.width) this.x = canvas.width - this.width*2; 
        if(this.x < 0) this.x = 0;
        if(this.y + this.height*2 > canvas.height) this.y = canvas.height - this.height*2; 
        if(this.y < 0) this.y = 0; 
        
        if(move==true) {
    
          this.x+=speed_x;
          this.y+=speed_y;
    
        }
    
    }
    shoot(){
       
        var bullet = new Bullets(this.x + this.width*0.95, this.y + this.height*0.73,bullet_width,bullet_height,degree  ,"red");
        bullets.push(bullet);
    
        }

  
   





}


class Bullets{
      constructor(x, y,width,height, angle, color){
        this.x = x;
        this.y = y;
        this.width=width;
        this.height=height;
        this.speed = 7;
        this.angle = angle; 
        this.color =color;
      }  
    
      update(){
        c.beginPath();
        c.save();
        c.fillStyle = this.color;
        c.translate(this.x + (this.width), this.y + (this.height));
        c.rotate(this.angle * Math.PI/180);
        c.translate(-this.x -(this.width/2), -this.y -this.height/2);
        
        c.font = "30px Arial";
        c.fillStyle = this.color;
        //c.textAlign = "center";
        //c.lineWidth=1;
        c.rect(this.x, this.y, this.width, this.height);
        //c.fillText("•", this.x, this.y);
        c.fill();
        c.stroke();
        c.restore();
        c.closePath();
    // Bullet movement
    this.x += this.speed * Math.sin( this.angle * Math.PI/180 );
    this.y += this.speed *( -Math.cos( this.angle * Math.PI/180 ));
     }


}


 player = new Player(window.innerWidth/2, window.innerHeight/2, tank1.width, tank1.height,player_health);

//GAMELOOP();

class Enemy{
  constructor(x, y, width, height, speed,health){
  this.x = x;
  this.y = y;
  this.width = width;
  this.height = height;
  this.speed = speed;
  this.health=health;
  }
  
  update(){
    
   
    if(this.x<tank1Pos.x){
        this.x+= this.speed;

    }if(this.x>tank1Pos.x){
        this.x-= this.speed;

    } if(this.y>tank1Pos.y){
        this.y-= this.speed;
    } if(this.y<tank1Pos.y){
        this.y+= this.speed;
    }
  
  
    c.beginPath();
    c.save();
    
    c.lineWidth=1;
    //c.rect(this.x, this.y, this.width, this.height/5);
    var health_left=(this.health/5);
    c.fillStyle="red"
    c.fillRect( this.x+this.width/2, this.y+this.height/2, this.width*health_left, this.height/10 );
    c.lineWidth=0.5;
    //c.rect(this.x+this.width/2, this.y+this.height/2, this.width, this.height);
    //c.fill();
    c.stroke();
    c.restore();
    c.closePath();
    c.drawImage(enemyImg, this.x+this.width/2, this.y+this.height/2,this.width,this.height);
  
  
}
}


function collision(a,b){
  return a.x < b.x + b.width &&
         a.x + a.width > b.x &&
         a.y < b.y + b.height &&
         a.y + a.height > b.y;
}


//draw n enemies into enemies array
function drawEnemies(){
  for (var _ = 0; _<10; _++){ 
    var x = Math.random()*(innerWidth-enemy_width);
    var y = Math.random()*(innerWidth-enemy_height);
    var width = enemy_width;
    var height = enemy_height;
    var speed = Math.random()*0.5;
    var health=enemy_health;
    var enemy = new Enemy(x, y, width, height, speed,health);
    enemies.push(enemy); 
  }
}

function  playerHeathDetection(){
      for (var i=enemies.length-1;i>=0;i--){
                      if(collision(player,enemies[i])){
                        player.health=player.health>0?player.health-0.1:player_health;
                        points-=1;
                        
                      }

       }
    }    
 function targetDeathDetection(){
        for (var i =bullets.length - 1; i >= 0; i--) {
            for (var j=enemies.length-1;j>=0;j--){

                    try {
                      if(collision(bullets[i],enemies[j])){
                          points+=5;
                          enemies[j].health-=1;
                          bullets.splice(i,1);
                      if(enemies[j].health<1){
                          enemies.splice(j,1);
                      }
                  
                
                      }
                    }
                    catch (e) {
 
                    }
                
            }
            
        }
 }
 

 function score(){
  c.beginPath();
  c.save();

  //c.font = "20px ";

  c.font = "bold 15pt Courier";

  c.fillStyle="black";
  c.fillText("🅂🄲🄾🅁🄴 :"+points,10,30);
  c.restore();
  c.closePath();
 }

function GAMELOOP(currentTime){

  window.requestAnimationFrame(GAMELOOP);
  c.clearRect(0, 0, canvas.width, canvas.height);
   
  if(enemies.length==0){
     drawEnemies();

  }


  for (var i = bullets.length - 1; i >= 0; i--){
    bullets[i].update();
    if (bullets[i].x < 0 || bullets[i].x > canvas.width || bullets[i].y > canvas.height || bullets[i].y < 0){
      bullets.splice(i, 1);
    }
  }
  
   player.update();
   
  
  
  if(fire==true){
    if(currentTime >= lastTime + 150){
  
      lastTime = currentTime;
      player.shoot();
      

     
  }    
    }


   if(currentTime >= lastTime + 500){
  
      //lastTime = currentTime;
      player.health=player.health<player_health?player.health+10:player_health;
      lastTime = currentTime;

     
  }  

    

  for(var x=enemies.length-1;x>=0;x--){
      enemies[x].update();
  }
 
  targetDeathDetection();
  playerHeathDetection();  
  score();
  
  
};
  
    GAMELOOP ();


  });
</script>

<style >

body {
    position: fixed;
    margin: 0;
    user-select: none;
    -webkit-user-select: none;
}
.pads {
    position: fixed;
    border-radius: 50%;
       user-select: none;
    -moz-user-select: none;
    -khtml-user-select: none;
    -webkit-user-select: none;
    -o-user-select: none;
}

#touchPad{
    border: 3px solid black;
    
    width:100px;
    height:100px;
    opacity:0.3;
    background-color:gray;
    
}

#padDot{
    border: 3px solid black;
    display:none;
    width:25px;
    height:25px;
    
    opacity:0.5;
    background-color: #f2f2f2;
    
    
}



#tank1{
width:30px;
height:50px;
    
    position:absolute;
}
  #navbar-iframe-container{
   display: none;
}

    
</style>
 </body>
</html>
